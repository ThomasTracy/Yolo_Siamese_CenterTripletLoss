# Yolo_Siamese_CenterTripletLoss
Yolo net combined with siames net or center&amp;triplet loss to recognize and classificate traffic signs
The Part of Yolo come from https://github.com/wizyoung/YOLOv3_TensorFlow
some of the readme can refer to above link 
The bonding boxes will be first generated by Yolo net, then the bboxes of traffic signs will
be classificated through either siamese net or center_triplet_loss

# Preparation
## Following is all necessary packages needed in my virtual environment
absl-py              0.9.0
astor                0.8.1
cycler               0.10.0
gast                 0.2.2
google-pasta         0.1.8
grpcio               1.27.2
h5py                 2.10.0
Keras-Applications   1.0.8
Keras-Preprocessing  1.1.0
kiwisolver           1.1.0
Markdown             3.2.1
matplotlib           3.2.0
numpy                1.18.1
opencv-python        4.2.0.32
opt-einsum           3.2.0
pip                  19.0.3
protobuf             3.11.3
pyparsing            2.4.6
python-dateutil      2.8.1
setuptools           45.2.0
six                  1.14.0
tensorboard          1.15.0
tensorflow-estimator 1.15.1
tensorflow-gpu       1.15.0
termcolor            1.1.0
tqdm                 4.43.0
Werkzeug             1.0.0
wheel                0.34.2
wrapt                1.12.0

## train or test data, pretrained models
Training set up can refer to original Yolo link, here we talk only about test
The saved names of images should be pure number, like 1.JPG or 11.png
Copy the 'path/to/test_images' to **line 239 of test_images.py** 

Put the pretrained weights(ckpt file) of Yolo in /path/to/YOLOv3_TensorFlow/checkpoint
The pretrained weights(pb file) is uploaded here in YOLOv3_TensorFlow/center_triplet_loss/model/frozen_graph/frozen_inference_graph.pb


# test
run test_images.py
the output will be saved in YOLOv3_TensorFlow/data/test_result.txt
the result seems like:

**path of input image     \t /t  x0 of bbox          y0                x1            y1           class of traffic sign**      
      path/to/2.JPG           2173.98         897.18            2256.66      981.90                    48
      
Test should be made on batched of images, if run on vdieo is needed. Then video needs to be converted into images

